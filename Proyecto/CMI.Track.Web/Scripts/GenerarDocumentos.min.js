var GenDocumentos={accEscritura:!1,accSeguridad:!1,Inicial:function(){$.ajaxSetup({cache:!1});this.Eventos();this.ValidaPermisos()},Eventos:function(){var n=this;$("#btnBuscarProyecto").click(n.onBuscarProyecto);$("#btnBuscarEtapa").click(n.onBuscarEtapa);$("#rptLGPResumen").click(n.onLGPResumen);$("#rptLGPDetalle").click(n.onLGPDetalle);$("#rptOPCorte").click(function(){n.onOrdenProduccion("C",this)});$("#rptOPPantografo").click(function(){n.onOrdenProduccion("P",this)});$("#rptRGMateriales").click(n.onRGMateriales)},onRGMateriales:function(){var i=$("#idProyectoSelect").val(),r=$("#idEtapaSelect").val(),n=this,t="",u=contextPath+"GenerarDocume/RGMateriales";t="idProyecto="+i+"&idEtapa="+r+"&idUsuario="+localStorage.idUser;CMI.botonMensaje(!0,n,"Requerimiento de Materiales");$.post(u,t,function(n){n.Success===!0?GenDocumentos.GeneraExcelRGMateriales(n):CMI.DespliegaErrorDialogo(n.Message)}).fail(function(){CMI.DespliegaErrorDialogo("No se pudo generar el Requerimiento General de Materiales.")}).always(function(){CMI.botonMensaje(!1,n,'  <span class="fa fa-archive"><\/span>   Requerimiento de Materiales')})},onOrdenProduccion:function(n,t){var u=$("#idProyectoSelect").val(),f=$("#idEtapaSelect").val(),i="",r="",e=contextPath+"GenerarDocume/OrdenProduccion";r="idProyecto="+u+"&idEtapa="+f+"&clase="+n;i=n==="P"?" Orden produccion Pantografo":"  Oreden produccion Corte";CMI.botonMensaje(!0,t,i);$.post(e,r,function(t){t.Success===!0?GenDocumentos.GeneraExcelOrdenProduccion(t,n):CMI.DespliegaErrorDialogo(t.Message)}).fail(function(){CMI.DespliegaErrorDialogo("No se pudo generar el reporte de Orden de produccion.")}).always(function(){i=n==="P"?'<span class="fa fa-codepen"><\/span>  Orden produccion Pantografo':'<span class="fa fa-scissors"><\/span>  Oreden produccion Corte';CMI.botonMensaje(!1,t,' <a href="#">   '+i+"<\/a>")})},onLGPDetalle:function(){var i=$("#idProyectoSelect").val(),r=$("#idEtapaSelect").val(),n=this,t="",u=contextPath+"GenerarDocume/LGPDetalle";t="idProyecto="+i+"&idEtapa="+r+"&idUsuario="+localStorage.idUser;CMI.botonMensaje(!0,n,"LGP Detalle");$.post(u,t,function(n){n.Success===!0?GenDocumentos.GeneraExcelLGPDetalle(n):CMI.DespliegaErrorDialogo(n.Message)}).fail(function(){CMI.DespliegaErrorDialogo("No se pudo generar el reporte LGPDetalle.")}).always(function(){CMI.botonMensaje(!1,n,' <span class="fa fa-list"><\/span>  LGP Detalle')})},onLGPResumen:function(){var i=$("#idProyectoSelect").val(),r=$("#idEtapaSelect").val(),n=this,t="",u=contextPath+"GenerarDocume/LGPResumen";t="idProyecto="+i+"&idEtapa="+r+"&idUsuario="+localStorage.idUser;CMI.botonMensaje(!0,n,"LGP Resumen");$.post(u,t,function(n){n.Success===!0?GenDocumentos.GeneraExcelLGPResumen(n):CMI.DespliegaErrorDialogo(n.Message)}).fail(function(){CMI.DespliegaErrorDialogo("No se pudo generar el reporte LGP Resumen.")}).always(function(){CMI.botonMensaje(!1,n,' <span class="fa fa-list"><\/span>  LGP Resumen')})},onBuscarProyecto:function(){var n=this,t;$(n).attr("disabled","disabled");CMI.CierraMensajes();t=contextPath+"Proyecto/BuscarProyecto";$.get(t,function(t){$("#buscar-General").html(t);$("#buscar-General").modal({backdrop:"static",keyboard:!0},"show");ProyectoBuscar.Inicial();ProyectoBuscar.parent=GenDocumentos;$(n).removeAttr("disabled")}).fail(function(){CMI.DespliegaErrorDialogo("No se pudo cargar el modulo de Buscar proyectos")}).always(function(){$(n).removeAttr("disabled")})},onBuscarEtapa:function(){var n=this,t;$(n).attr("disabled","disabled");CMI.CierraMensajes();t=contextPath+"Etapa/BuscarEtapa";$.get(t,function(t){$("#buscar-General").html(t);$("#buscar-General").modal({backdrop:"static",keyboard:!0},"show");EtapaBuscar.idProyecto=$("#idProyectoSelect").val();EtapaBuscar.revisionProyecto=$("#RevisionPro").text();EtapaBuscar.parent=GenDocumentos;EtapaBuscar.Inicial();$(n).removeAttr("disabled")}).fail(function(){CMI.DespliegaErrorDialogo("No se pudo cargar el modulo de Buscar proyectos")}).always(function(){$(n).removeAttr("disabled")})},AsignaProyecto:function(n,t,i,r,u,f){$("#idProyectoSelect").val(n);$("#RevisionPro").text(t);$("#nombreProyecto").text(i);$("#CodigoProyecto").text(r);$("#FechaInicio").text(u);$("#FechaFin").text(f);$("#buscar-General").modal("hide");$("#idEtapaSelect").val(0);$("#nombreEtapa").text("Nombre Etapa");$("#FechaInicioEtapa").text("Fecha Inicio");$("#FechaFinEtapa").text("Fecha Fin");$("#frmListaPartes").hide();$("#etapaRow").show();$(".acciones").hide()},AsignaEtapa:function(n,t,i,r){$("#idEtapaSelect").val(n);$("#nombreEtapa").text(t);$("#FechaInicioEtapa").text(i);$("#FechaFinEtapa").text(r);$("#buscar-General").modal("hide");$(".acciones").show()},ValidaPermisos:function(){var n=localStorage.modPermisos,t=GenDocumentos;t.accEscritura=n.substr(1,1)==="1"?!0:!1;t.accBorrar=n.substr(2,1)==="1"?!0:!1;t.accClonar=n.substr(3,1)==="1"?!0:!1},GeneraExcelLGPResumen:function(n){var t="",o="",u="",i="<table border='2'>",s="",h=$("#nombreEtapa").text().replace(/ /g,"&nbsp;"),f,r;if(n.Excel!==null)for(f=0;f<n.Excel.length;f++)r=n.Excel[f],t+="<tr>",t+="<td>"+h+"<\/td>",t+="<td>"+r.planoMontaje.replace(/ /g,"&nbsp;")+"<\/td>",t+="<td>"+r.planoDespiece.replace(/ /g,"&nbsp;")+"<\/td>",t+="<td>"+r.tipoConstruccion.replace(/ /g,"&nbsp;")+"<\/td>",t+="<td>"+r.marca.replace(/ /g,"&nbsp;")+"<\/td>",t+="<td>"+r.piezaMarca+"<\/td>",t+="<td>"+r.submarca.replace(/ /g,"&nbsp;")+"<\/td>",t+="<td>"+r.perfil.replace(/ /g,"&nbsp;")+"<\/td>",t+="<td>"+r.piezas+"<\/td>",t+="<td>"+r.corte+"<\/td>",t+="<td>"+r.longitud+"<\/td>",t+="<td>"+r.ancho+"<\/td>",t+="<td>"+r.grado.replace(/ /g,"&nbsp;")+"<\/td>",t+="<td>"+r.kgm+"<\/td>",t+="<td>"+r.totalLA+"<\/td>",t+="<td>"+r.total+"<\/td>",t+="<td>"+r.peso+"<\/td>",t+="<\/tr>";i+="<tr>";i+="<td colspan='3'><img src='"+routeUrlImages+"/CMI.TRACK.reportes.png' /><\/td>";i+="<td > <table> ";i+="        <tr> <td colspan='11' align='center'><strong> Listado General de Partes Resumen<\/strong><\/td> <\/tr><tr > <td colspan='2'> <\/td> <\/tr> ";i+="        <tr> <td colspan='11' align='center'><strong> "+$("#nombreProyecto").text()+" - "+$("#nombreEtapa").text()+" <\/strong><\/td> <\/tr><tr> <td colspan='2'> <\/td><\/tr> ";i+="      <\/table>";i+=" <\/td> ";i+="<td> ";i+="    <table ><tr> <td><\/td> <\/tr><tr align='right'> <td>Codigo:<\/td><\/tr><tr align='right'><td >Revision:<\/td><\/tr><tr align='right'> <td >Fecha:<\/td><\/tr><tr><td><\/td><\/tr><\/table>";i+="<\/td>";i+="<td> ";i+="    <table><tr align='center'><\/tr><tr align='center'><td ><strong>"+$("#CodigoProyecto").text()+"<\/strong><\/td><\/tr><tr align='center'><td><strong>"+$("#RevisionPro").text()+"<\/strong><\/td><\/tr>";i+="      <tr><td  align='center'><strong>"+n.fecha+"<\/strong><\/td><\/tr>";i+="    <\/table>";i+="<\/td>";i+="<\/tr> ";o="<table  border='2' ><tr align='center'><td rowspan='2'><strong>Etapa<\/strong><\/td><td rowspan='2'><strong>Montaje<\/strong><\/td><td rowspan='2'><strong>Despiece<\/strong><\/td><td rowspan='2' colspan='1'><strong>Tipo Construccion<\/strong><\/td><td rowspan='2' colspan='1'><strong>Marcan<\/strong><\/td><td rowspan='2' colspan='1'><strong>Piezas<\/strong><\/td><td rowspan='2'><strong>SubMarcas<\/strong><\/td><td rowspan='2'><strong>Perfil<\/strong><\/td><td rowspan='2'><strong>Piezas<\/strong><\/td><td rowspan='2'><strong>Corte<\/strong><\/td><td rowspan='2'><strong>Longitud<\/strong><\/td><td rowspan='2'><strong>Ancho<\/strong><\/td><td rowspan='2'><strong>Grado<\/strong><\/td><td rowspan='2'><strong>Kgm<\/strong><\/td><td rowspan='2'><strong>Total LA<\/strong><\/td><td rowspan='2'><strong>Total<\/strong><\/td><td rowspan='2'><strong>Peso<\/strong><\/td><\/tr><\/table>";u="<table border='2'><tr><td><table border='1'>";u+=t;u+="<\/table><\/td><\/tr><\/table>";i+=o+u;var e=document.createElement("a"),c=i;s=c.replace(/ /g,"%20");e.href="data:application/vnd.ms-excel, "+s;e.download="LGP Resumen.xls";e.click()},GeneraExcelLGPDetalle:function(n){var t="",o="",u="",i="<table border='2'>",s="",h=$("#nombreEtapa").text().replace(/ /g,"&nbsp;"),f,r;if(n.Excel!==null)for(f=0;f<n.Excel.length;f++)r=n.Excel[f],t+="<tr>",t+="<td>"+h+"<\/td>",t+="<td>"+r.planoMontaje.replace(/ /g,"&nbsp;")+"<\/td>",t+="<td>"+r.planoDespiece.replace(/ /g,"&nbsp;")+"<\/td>",t+="<td>"+r.tipoConstruccion.replace(/ /g,"&nbsp;")+"<\/td>",t+="<td>"+r.marca.replace(/ /g,"&nbsp;")+"<\/td>",t+="<td>"+r.piezaMarca+"<\/td>",t+="<td>"+r.submarca.replace(/ /g,"&nbsp;")+"<\/td>",t+="<td>"+r.perfil.replace(/ /g,"&nbsp;")+"<\/td>",t+="<td>"+r.piezas+"<\/td>",t+="<td>"+r.corte+"<\/td>",t+="<td>"+r.longitud+"<\/td>",t+="<td>"+r.ancho+"<\/td>",t+="<td>"+r.grado.replace(/ /g,"&nbsp;")+"<\/td>",t+="<td>"+r.kgm+"<\/td>",t+="<td>"+r.totalLA+"<\/td>",t+="<td>"+r.total+"<\/td>",t+="<td>"+r.peso+"<\/td>",t+="<\/tr>";i+="<tr>";i+="<td colspan='3'><img src='"+routeUrlImages+"/CMI.TRACK.reportes.png' /><\/td>";i+="<td > <table> ";i+="        <tr> <td colspan='11' align='center'><strong> Listado General de Partes Detalle <\/strong><\/td> <\/tr><tr > <td colspan='2'> <\/td> <\/tr> ";i+="        <tr> <td colspan='11' align='center'><strong> "+$("#nombreProyecto").text()+" - "+$("#nombreEtapa").text()+" <\/strong><\/td> <\/tr><tr> <td colspan='2'> <\/td><\/tr> ";i+="      <\/table>";i+=" <\/td> ";i+="<td> ";i+="    <table ><tr> <td><\/td> <\/tr><tr align='right'> <td>Codigo:<\/td><\/tr><tr align='right'><td >Revision:<\/td><\/tr><tr align='right'> <td >Fecha:<\/td><\/tr><tr><td><\/td><\/tr><\/table>";i+="<\/td>";i+="<td> ";i+="    <table><tr align='center'><\/tr><tr align='center'><td ><strong>"+$("#CodigoProyecto").text()+"<\/strong><\/td><\/tr><tr align='center'><td><strong>"+$("#RevisionPro").text()+"<\/strong><\/td><\/tr>";i+="      <tr><td  align='center'><strong>"+n.fecha+"<\/strong><\/td><\/tr>";i+="    <\/table>";i+="<\/td>";i+="<\/tr> ";o="<table  border='2' ><tr align='center'><td rowspan='2'><strong>Etapa<\/strong><\/td><td rowspan='2'><strong>Montaje<\/strong><\/td><td rowspan='2'><strong>Despiece<\/strong><\/td><td rowspan='2' colspan='1'><strong>Tipo Construccion<\/strong><\/td><td rowspan='2' colspan='1'><strong>Marcan<\/strong><\/td><td rowspan='2' colspan='1'><strong>Piezas<\/strong><\/td><td rowspan='2'><strong>SubMarcas<\/strong><\/td><td rowspan='2'><strong>Perfil<\/strong><\/td><td rowspan='2'><strong>Piezas<\/strong><\/td><td rowspan='2'><strong>Corte<\/strong><\/td><td rowspan='2'><strong>Longitud<\/strong><\/td><td rowspan='2'><strong>Ancho<\/strong><\/td><td rowspan='2'><strong>Grado<\/strong><\/td><td rowspan='2'><strong>Kgm<\/strong><\/td><td rowspan='2'><strong>Total LA<\/strong><\/td><td rowspan='2'><strong>Total<\/strong><\/td><td rowspan='2'><strong>Peso<\/strong><\/td><\/tr><\/table>";u="<table border='2'><tr><td><table border='1'>";u+=t;u+="<\/table><\/td><\/tr><\/table>";i+=o+u;var e=document.createElement("a"),c=i;s=c.replace(/ /g,"%20");e.href="data:application/vnd.ms-excel, "+s;e.download="LGP Detalle.xls";e.click()},GeneraExcelOrdenProduccion:function(n,t){var i="",s="",f="",r="<table border='2'>",h="",c=t==="P"?"Pantografo":"Corte",l=$("#nombreEtapa").text().replace(/ /g,"&nbsp;"),e,u;if(n.Excel!==null)for(e=0;e<n.Excel.length;e++)u=n.Excel[e],i+="<tr>",i+="<td>"+l+"<\/td>",i+="<td>"+u.planoMontaje.replace(/ /g,"&nbsp;")+"<\/td>",i+="<td>"+u.planoDespiece.replace(/ /g,"&nbsp;")+"<\/td>",i+="<td>"+u.marca.replace(/ /g,"&nbsp;")+"<\/td>",i+="<td>"+u.piezaMarca+"<\/td>",i+="<td>"+u.submarca.replace(/ /g,"&nbsp;")+"<\/td>",i+="<td>"+u.perfil.replace(/ /g,"&nbsp;")+"<\/td>",i+="<td>"+u.piezas+"<\/td>",i+="<td>"+u.corte+"<\/td>",i+="<td>"+u.longitud+"<\/td>",i+="<td>"+u.ancho+"<\/td>",i+="<td>"+u.grado.replace(/ /g,"&nbsp;")+"<\/td>",i+="<td>"+u.kgm+"<\/td>",i+="<td>"+u.totalLA+"<\/td>",i+="<td>"+u.total+"<\/td>",i+="<td>"+u.peso+"<\/td>",i+="<\/tr>";r+="<tr>";r+="<td colspan='3'><img src='"+routeUrlImages+"/CMI.TRACK.reportes.png' /><\/td>";r+="<td > <table> ";r+="        <tr> <td colspan='11' align='center'><strong>Orden de Produccion de "+c+" <\/strong><\/td> <\/tr><tr > <td colspan='2'> <\/td> <\/tr> ";r+="        <tr> <td colspan='11' align='center'><strong> "+$("#nombreProyecto").text()+" - "+$("#nombreEtapa").text()+" <\/strong><\/td> <\/tr><tr> <td colspan='2'> <\/td><\/tr> ";r+="      <\/table>";r+=" <\/td> ";r+="<td> ";r+="    <table ><tr> <td><\/td> <\/tr><tr align='right'> <td>Codigo:<\/td><\/tr><tr align='right'><td >Revision:<\/td><\/tr><tr align='right'> <td >Fecha:<\/td><\/tr><tr><td><\/td><\/tr><\/table>";r+="<\/td>";r+="<td> ";r+="    <table><tr align='center'><\/tr><tr align='center'><td ><strong>"+$("#CodigoProyecto").text()+"<\/strong><\/td><\/tr><tr align='center'><td><strong>"+$("#RevisionPro").text()+"<\/strong><\/td><\/tr>";r+="      <tr><td  align='center'><strong>"+n.fecha+"<\/strong><\/td><\/tr>";r+="    <\/table>";r+="<\/td>";r+="<\/tr> ";s="<table  border='2' ><tr align='center'><td rowspan='2'><strong>Etapa<\/strong><\/td><td rowspan='2'><strong>Montaje<\/strong><\/td><td rowspan='2'><strong>Despiece<\/strong><\/td><td rowspan='2' colspan='1'><strong>Marca<\/strong><\/td><td rowspan='2' colspan='1'><strong>Piezas<\/strong><\/td><td rowspan='2'><strong>SubMarcas<\/strong><\/td><td rowspan='2'><strong>Perfil<\/strong><\/td><td rowspan='2'><strong>Piezas<\/strong><\/td><td rowspan='2'><strong>Corte<\/strong><\/td><td rowspan='2'><strong>Longitud<\/strong><\/td><td rowspan='2'><strong>Ancho<\/strong><\/td><td rowspan='2'><strong>Grado<\/strong><\/td><td rowspan='2'><strong>Kgm<\/strong><\/td><td rowspan='2'><strong>Total LA<\/strong><\/td><td rowspan='2'><strong>Total<\/strong><\/td><td rowspan='2'><strong>Peso<\/strong><\/td><\/tr><\/table>";f="<table border='2'><tr><td><table border='1'>";f+=i;f+="<\/table><\/td><\/tr><\/table>";r+=s+f;var o=document.createElement("a"),a=r;h=a.replace(/ /g,"%20");o.href="data:application/vnd.ms-excel, "+h;o.download="RequerimientoGeneralMateriales.xls";o.click()},GeneraExcelRGMateriales:function(n){var i="",o="",s=0,u="",r="<table border='2'>",h="",f,t;if(n.Excel.lstDetalle!==null)for(f=0;f<n.Excel.lstDetalle.length;f++)t=n.Excel.lstDetalle[f],i+="<tr>",i+="<td><\/td>",i+="<td>"+t.piezasReqGenMat+"<\/td>",i+="<td>PZA<\/td>",i+="<td>"+t.perfilReqGenMat.replace(/ /g,"&nbsp;")+"<\/td>",i+="<td>"+t.gradoReqGenMat.replace(/ /g,"&nbsp;")+"<\/td>",i+="<td>"+t.anchoReqGenMat+"<\/td>",i+="<td>"+t.longitudReqGenMat+"<\/td>",i+="<td>"+parseFloat(t.anchoReqGenMat)*.3048*parseFloat(t.longitudReqGenMat)*.3048+"<\/td>",i+="<td>"+t.kgmReqGenMat+"<\/td>",i+="<td>"+t.piezasReqGenMat*t.longitudReqGenMat*.3048*t.kgmReqGenMat+"<\/td>",i+="<\/tr>",s+=t.piezasReqGenMat*t.longitudReqGenMat*.3048*t.kgmReqGenMat;r+="<tr>";r+="<td colspan='3'><img src='"+routeUrlImages+"/CMI.TRACK.reportes.png' /><\/td>";r+="<td > <table> <tr > <td colspan='2'> <\/td> <\/tr>";r+="<tr> <td colspan='2' align='center'><strong>REQUERIMIENTO<\/strong><\/td> <\/tr> ";r+="<tr> <td colspan='2' align='center'><strong> ETAPA #"+n.Excel.claveEtapa+"<\/strong><\/td> <\/tr><tr> <td colspan='2'> <\/td><\/tr> ";r+="<tr> <td colspan='2' align='center'><strong><i> "+n.Excel.nombreEtapa+"<\/i><\/strong> <\/td> <\/tr> <tr> <td colspan='2' align='center'style='color:red;'><strong>Rev."+n.Excel.revisionProyecto+"<\/strong><\/td><\/tr><\/table><\/td> ";r+="<td> <table > <tr align='right'><td><\/td><td><\/td><td><\/td><td style='border:solid;border-size:2;' align='center'><strong>No.<\/strong><\/td><\/tr> <tr align='center'>  <td><\/td><td><\/td><td><\/td> <td style='border:solid;border-size:2;'><strong>"+n.Excel.idProyecto+"<\/strong><\/td> <\/tr><tr align='right'> <td  colspan='4'>FECHA:<\/td><\/tr><tr align='right'><td colspan='4'>Folio Req.<\/td><\/tr><tr align='right'> <td  colspan='4'>DEPARTAMENTO:<\/td><\/tr><tr align='right'><td  colspan='4'>SOLICITADO POR:<\/td><\/tr><\/table>";r+="<\/td><td><table><tr align='center'><td style='border:solid;border-size:2';>PROYECTO<\/td><\/tr><tr align='center'><td style='border:solid;border-size:2;'><strong>"+$("#nombreProyecto").text()+"<\/strong><\/td><\/tr><tr align='center'><td><strong>"+n.Excel.fechaSolicitud+"<\/strong><\/td><\/tr>";r+="<tr><td  align='center'><strong>"+n.Excel.folioRequerimiento+"<\/strong><\/td><\/tr>";r+="<tr><td  align='center'>"+n.Excel.departamentoP+"<\/td><\/tr>";r+="<tr><td  align='center'>"+n.Excel.solicitado+"<\/td><\/tr><\/table><\/td><\/tr>";o="<table  border='2' ><tr align='center'><td rowspan='2'><strong>Partida<\/strong><\/td><td rowspan='2'><strong>Cantidad<\/strong><\/td><td rowspan='2'><strong>Unidad<\/strong><\/td><td rowspan='2' colspan='1'><strong>DESCRIPCION<\/strong><\/td><td rowspan='2' colspan='1'><strong>Calidad<br>de Acero<\/strong><\/td><td rowspan='2'><strong>Ancho<br>(ft.)<\/strong><\/td><td rowspan='2'><strong>Long.<br>( ft.)<\/strong><\/td><td rowspan='2'><strong>Long.(m)<br>Area (m2)<\/strong><\/td><td rowspan='2'><strong>Kg/m<br>Kg/m2<\/strong><\/td><td rowspan='2'><strong>TOTAL<br>( Kg )<\/strong><\/td><\/tr><\/table>";u="<table border='2'><tr><td><table border='1'>";u+=i;u+="<\/table><\/td><\/tr><table><tr><td colspan='8'><\/td><td align='right'>TOTAL<\/td><td style='border:solid;border-size:2;'>"+s+"<\/td><\/tr><\/table><\/table>";r+=o+u;var e=document.createElement("a"),c=r;h=c.replace(/ /g,"%20");e.href="data:application/vnd.ms-excel, "+h;e.download="RequerimientoGeneralMateriales.xls";e.click()}};$(function(){GenDocumentos.Inicial()});
//# sourceMappingURL=GenerarDocumentos.min.js.map
