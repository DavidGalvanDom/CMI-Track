var GenDocumentos={accEscritura:!1,accSeguridad:!1,Inicial:function(){$.ajaxSetup({cache:!1});this.Eventos();this.ValidaPermisos()},Eventos:function(){var n=this;$("#btnBuscarProyecto").click(n.onBuscarProyecto);$("#btnBuscarEtapa").click(n.onBuscarEtapa);$("#rptLGPResumen").click(n.onLGPResumen);$("#rptLGPDespiece").click(n.onLGPDespiece);$("#rptOPCorte").click(n.onOPCorte);$("#rptOPPantografo").click(n.onOPPantografo);$("#rptRGMateriales").click(n.onRGMateriales)},onRGMateriales:function(){var i=$("#idProyectoSelect").val(),r=$("#idEtapaSelect").val(),n=this,t="",u=contextPath+"GenerarDocume/RGMateriales";t="idProyecto="+i+"&idEtapa="+r+"&idUsuario="+localStorage.idUser;$(n).attr("disabled","disabled");$.post(u,t,function(n){GenDocumentos.GeneraExcelRGMateriales(n)}).fail(function(){CMI.DespliegaErrorDialogo("No se pudo generar el Requerimiento General de Materiales.")}).always(function(){$(n).removeAttr("disabled")})},onOPPantografo:function(){},onOPCorte:function(){},onLGPDespiece:function(){},onLGPResumen:function(){var i=$("#idProyectoSelect").val(),r=$("#idEtapaSelect").val(),n="",t=this,u=contextPath+"GenerarDocumentos/LGPResumen";n="idProyecto="+i+"&idEtapa="+r;$(t).attr("disabled","disabled");$.post(u,n,function(n){console.log(n)}).fail(function(){CMI.DespliegaErrorDialogo("No se pudo generar el Resumen de la lista general de partes.")}).always(function(){$(t).removeAttr("disabled")})},onBuscarProyecto:function(){var n=this,t;$(n).attr("disabled","disabled");CMI.CierraMensajes();t=contextPath+"Proyecto/BuscarProyecto";$.get(t,function(t){$("#buscar-General").html(t);$("#buscar-General").modal({backdrop:"static",keyboard:!0},"show");ProyectoBuscar.Inicial();ProyectoBuscar.parent=GenDocumentos;$(n).removeAttr("disabled")}).fail(function(){CMI.DespliegaErrorDialogo("No se pudo cargar el modulo de Buscar proyectos")}).always(function(){$(n).removeAttr("disabled")})},onBuscarEtapa:function(){var n=this,t;$(n).attr("disabled","disabled");CMI.CierraMensajes();t=contextPath+"Etapa/BuscarEtapa";$.get(t,function(t){$("#buscar-General").html(t);$("#buscar-General").modal({backdrop:"static",keyboard:!0},"show");EtapaBuscar.idProyecto=$("#idProyectoSelect").val();EtapaBuscar.revisionProyecto=$("#RevisionPro").text();EtapaBuscar.parent=GenDocumentos;EtapaBuscar.Inicial();$(n).removeAttr("disabled")}).fail(function(){CMI.DespliegaErrorDialogo("No se pudo cargar el modulo de Buscar proyectos")}).always(function(){$(n).removeAttr("disabled")})},AsignaProyecto:function(n,t,i,r,u,f){$("#idProyectoSelect").val(n);$("#RevisionPro").text(t);$("#nombreProyecto").text(i);$("#CodigoProyecto").text(r);$("#FechaInicio").text(u);$("#FechaFin").text(f);$("#buscar-General").modal("hide");$("#idEtapaSelect").val(0);$("#nombreEtapa").text("Nombre Etapa");$("#FechaInicioEtapa").text("Fecha Inicio");$("#FechaFinEtapa").text("Fecha Fin");$("#frmListaPartes").hide();$("#etapaRow").show();$(".acciones").hide()},AsignaEtapa:function(n,t,i,r){$("#idEtapaSelect").val(n);$("#nombreEtapa").text(t);$("#FechaInicioEtapa").text(i);$("#FechaFinEtapa").text(r);$("#buscar-General").modal("hide");$(".acciones").show()},ValidaPermisos:function(){var n=localStorage.modPermisos,t=GenDocumentos;t.accEscritura=n.substr(1,1)==="1"?!0:!1;t.accBorrar=n.substr(2,1)==="1"?!0:!1;t.accClonar=n.substr(3,1)==="1"?!0:!1},GeneraExcelRGMateriales:function(n){var r=contextPath+"Content/template/rpt_GeneralMateriales.html",t="",i="";$.get(r,function(r){var u,f,e;for(contador=0;contador<n.Excel.lstDetalle.length;contador++)u=n.Excel.lstDetalle[contador],t+="<tr>",t+="<td><\/td>",t+="<td>"+u.piezasReqGenMat+"<\/td>",t+="<td>PZA<\/td>",t+="<td>"+u.perfilReqGenMat.replace(/ /g,"&nbsp;")+"<\/td>",t+="<td>"+u.gradoReqGenMat.replace(/ /g,"&nbsp;")+"<\/td>",t+="<td>"+u.anchoReqGenMat+"<\/td>",t+="<td>"+u.longitudReqGenMat+"<\/td>",t+="<td>"+parseFloat(u.anchoReqGenMat)*.3048*parseFloat(u.longitudReqGenMat)*.3048+"<\/td>",t+="<td>"+u.kgmReqGenMat+"<\/td>",t+="<td><\/td>",t+="<\/tr>";r=r.replace("&idProyecto&",n.Excel.idProyecto);r=r.replace("&NomProyecto&",$("#nombreProyecto").text());r=r.replace("&FechaDoc&",n.Excel.fechaSolicitud);r=r.replace("&FolioReq&",n.Excel.folioRequerimiento);r=r.replace("&NomEtapa&",n.Excel.nombreEtapa);r=r.replace("&Depto&",n.Excel.departamentoP);r=r.replace("&claveEtapa&",n.Excel.claveEtapa);r=r.replace("&solicitado&",n.Excel.solicitado);i=r.replace("&renglones&",t);console.log(i);f=document.createElement("a");e="data:application/vnd.ms-excel";f.href=e+", "+i;f.download="ReporteGeneralMateriales.xls";f.click()})}};$(function(){GenDocumentos.Inicial()});
//# sourceMappingURL=GenerarDocumentos.min.js.map
