var GenDocumentos={accEscritura:!1,accSeguridad:!1,Inicial:function(){$.ajaxSetup({cache:!1});this.Eventos();this.ValidaPermisos()},Eventos:function(){var n=this;$("#btnBuscarProyecto").click(n.onBuscarProyecto);$("#btnBuscarEtapa").click(n.onBuscarEtapa);$("#rptLGPResumen").click(n.onLGPResumen);$("#rptLGPDespiece").click(n.onLGPDespiece);$("#rptOPCorte").click(n.onOPCorte);$("#rptOPPantografo").click(n.onOPPantografo);$("#rptRGMateriales").click(n.onRGMateriales)},onRGMateriales:function(){var i=$("#idProyectoSelect").val(),r=$("#idEtapaSelect").val(),n=this,t="",u=contextPath+"GenerarDocume/RGMateriales";t="idProyecto="+i+"&idEtapa="+r+"&idUsuario="+localStorage.idUser;CMI.botonMensaje(!0,n,"Requerimiento de Materiales");$.post(u,t,function(n){n.Success===!0?GenDocumentos.GeneraExcelRGMateriales(n):CMI.DespliegaErrorDialogo(n.Message)}).fail(function(){CMI.DespliegaErrorDialogo("No se pudo generar el Requerimiento General de Materiales.")}).always(function(){CMI.botonMensaje(!1,n,' <a href="#">   <span class="fa fa-archive"><\/span>   Requerimiento de Materiales<\/a>')})},onOPPantografo:function(){},onOPCorte:function(){},onLGPDespiece:function(){},onLGPResumen:function(){var i=$("#idProyectoSelect").val(),r=$("#idEtapaSelect").val(),n="",t=this,u=contextPath+"GenerarDocumentos/LGPResumen";n="idProyecto="+i+"&idEtapa="+r;$(t).attr("disabled","disabled");$.post(u,n,function(n){console.log(n)}).fail(function(){CMI.DespliegaErrorDialogo("No se pudo generar el Resumen de la lista general de partes.")}).always(function(){$(t).removeAttr("disabled")})},onBuscarProyecto:function(){var n=this,t;$(n).attr("disabled","disabled");CMI.CierraMensajes();t=contextPath+"Proyecto/BuscarProyecto";$.get(t,function(t){$("#buscar-General").html(t);$("#buscar-General").modal({backdrop:"static",keyboard:!0},"show");ProyectoBuscar.Inicial();ProyectoBuscar.parent=GenDocumentos;$(n).removeAttr("disabled")}).fail(function(){CMI.DespliegaErrorDialogo("No se pudo cargar el modulo de Buscar proyectos")}).always(function(){$(n).removeAttr("disabled")})},onBuscarEtapa:function(){var n=this,t;$(n).attr("disabled","disabled");CMI.CierraMensajes();t=contextPath+"Etapa/BuscarEtapa";$.get(t,function(t){$("#buscar-General").html(t);$("#buscar-General").modal({backdrop:"static",keyboard:!0},"show");EtapaBuscar.idProyecto=$("#idProyectoSelect").val();EtapaBuscar.revisionProyecto=$("#RevisionPro").text();EtapaBuscar.parent=GenDocumentos;EtapaBuscar.Inicial();$(n).removeAttr("disabled")}).fail(function(){CMI.DespliegaErrorDialogo("No se pudo cargar el modulo de Buscar proyectos")}).always(function(){$(n).removeAttr("disabled")})},AsignaProyecto:function(n,t,i,r,u,f){$("#idProyectoSelect").val(n);$("#RevisionPro").text(t);$("#nombreProyecto").text(i);$("#CodigoProyecto").text(r);$("#FechaInicio").text(u);$("#FechaFin").text(f);$("#buscar-General").modal("hide");$("#idEtapaSelect").val(0);$("#nombreEtapa").text("Nombre Etapa");$("#FechaInicioEtapa").text("Fecha Inicio");$("#FechaFinEtapa").text("Fecha Fin");$("#frmListaPartes").hide();$("#etapaRow").show();$(".acciones").hide()},AsignaEtapa:function(n,t,i,r){$("#idEtapaSelect").val(n);$("#nombreEtapa").text(t);$("#FechaInicioEtapa").text(i);$("#FechaFinEtapa").text(r);$("#buscar-General").modal("hide");$(".acciones").show()},ValidaPermisos:function(){var n=localStorage.modPermisos,t=GenDocumentos;t.accEscritura=n.substr(1,1)==="1"?!0:!1;t.accBorrar=n.substr(2,1)==="1"?!0:!1;t.accClonar=n.substr(3,1)==="1"?!0:!1},GeneraExcelRGMateriales:function(n){var i="",o="",s=0,u="",r="<table border='2'>",h="",f,t;if(n.Excel.lstDetalle!==null)for(f=0;f<n.Excel.lstDetalle.length;f++)t=n.Excel.lstDetalle[f],i+="<tr>",i+="<td><\/td>",i+="<td>"+t.piezasReqGenMat+"<\/td>",i+="<td>PZA<\/td>",i+="<td>"+t.perfilReqGenMat.replace(/ /g,"&nbsp;")+"<\/td>",i+="<td>"+t.gradoReqGenMat.replace(/ /g,"&nbsp;")+"<\/td>",i+="<td>"+t.anchoReqGenMat+"<\/td>",i+="<td>"+t.longitudReqGenMat+"<\/td>",i+="<td>"+parseFloat(t.anchoReqGenMat)*.3048*parseFloat(t.longitudReqGenMat)*.3048+"<\/td>",i+="<td>"+t.kgmReqGenMat+"<\/td>",i+="<td>"+t.piezasReqGenMat*t.longitudReqGenMat*.3048*t.kgmReqGenMat+"<\/td>",i+="<\/tr>",s+=t.piezasReqGenMat*t.longitudReqGenMat*.3048*t.kgmReqGenMat;r+="<tr>";r+="<td colspan='3'><img src='"+routeUrlImages+"/CMI.TRACK.reportes.png' /><\/td>";r+="<td > <table> <tr > <td colspan='2'> <\/td> <\/tr>";r+="<tr> <td colspan='2' align='center'><strong>REQUERIMIENTO<\/strong><\/td> <\/tr> ";r+="<tr> <td colspan='2' align='center'><strong> ETAPA #"+n.Excel.claveEtapa+"<\/strong><\/td> <\/tr><tr> <td colspan='2'> <\/td><\/tr> ";r+="<tr> <td colspan='2' align='center'><strong><i> "+n.Excel.nombreEtapa+"<\/i><\/strong> <\/td> <\/tr> <tr> <td colspan='2' align='center'style='color:red;'><strong>Rev."+n.Excel.revisionProyecto+"<\/strong><\/td><\/tr><\/table><\/td> ";r+="<td> <table > <tr align='right'><td><\/td><td><\/td><td><\/td><td style='border:solid;border-size:2;' align='center'><strong>No.<\/strong><\/td><\/tr> <tr align='center'>  <td><\/td><td><\/td><td><\/td> <td style='border:solid;border-size:2;'><strong>"+n.Excel.idProyecto+"<\/strong><\/td> <\/tr><tr align='right'> <td  colspan='4'>FECHA:<\/td><\/tr><tr align='right'><td colspan='4'>Folio Req.<\/td><\/tr><tr align='right'> <td  colspan='4'>DEPARTAMENTO:<\/td><\/tr><tr align='right'><td  colspan='4'>SOLICITADO POR:<\/td><\/tr><\/table>";r+="<\/td><td><table><tr align='center'><td style='border:solid;border-size:2';>PROYECTO<\/td><\/tr><tr align='center'><td style='border:solid;border-size:2;'><strong>"+$("#nombreProyecto").text()+"<\/strong><\/td><\/tr><tr align='center'><td><strong>"+n.Excel.fechaSolicitud+"<\/strong><\/td><\/tr>";r+="<tr><td  align='center'><strong>"+n.Excel.folioRequerimiento+"<\/strong><\/td><\/tr>";r+="<tr><td  align='center'>"+n.Excel.departamentoP+"<\/td><\/tr>";r+="<tr><td  align='center'>"+n.Excel.solicitado+"<\/td><\/tr><\/table><\/td><\/tr>";o="<table  border='2' ><tr align='center'><td rowspan='2'><strong>Partida<\/strong><\/td><td rowspan='2'><strong>Cantidad<\/strong><\/td><td rowspan='2'><strong>Unidad<\/strong><\/td><td rowspan='2' colspan='1'><strong>DESCRIPCION<\/strong><\/td><td rowspan='2' colspan='1'><strong>Calidad<br>de Acero<\/strong><\/td><td rowspan='2'><strong>Ancho<br>(ft.)<\/strong><\/td><td rowspan='2'><strong>Long.<br>( ft.)<\/strong><\/td><td rowspan='2'><strong>Long.(m)<br>Area (m2)<\/strong><\/td><td rowspan='2'><strong>Kg/m<br>Kg/m2<\/strong><\/td><td rowspan='2'><strong>TOTAL<br>( Kg )<\/strong><\/td><\/tr><\/table>";u="<table border='2'><tr><td><table border='1'>";u+=i;u+="<\/table><\/td><\/tr><table><tr><td colspan='8'><\/td><td align='right'>TOTAL<\/td><td style='border:solid;border-size:2;'>"+s+"<\/td><\/tr><\/table><\/table>";r+=o+u;var e=document.createElement("a"),c=r;h=c.replace(/ /g,"%20");e.href="data:application/vnd.ms-excel, "+h;e.download="RequerimientoGeneralMateriales.xls";e.click()}};$(function(){GenDocumentos.Inicial()});
//# sourceMappingURL=GenerarDocumentos.min.js.map
